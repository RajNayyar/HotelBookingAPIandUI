<!-- Tab links -->
<html>
<head>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="tab">
  <button class="tablinks" onclick="openCar(event, 'Car')">Cars</button>
  <button class="tablinks" onclick="openHotel(event, 'Hotel')">Hotels</button>
  <button class="tablinks" onclick="openActivity(event, 'Activity')">Activity</button>
  <button class="tablinks" onclick="openFlight(event, 'Flight')">Flights</button>
</div>

<div class = "forms">
		<form id="Airways-Form">
			<input type="text" placeholder="Name" class="Air">
			<input type="text" placeholder="Price" class="Air">
			<input type="text" placeholder="Source" class="Air">
			<input type="text" placeholder="Destination" class="Air">
			<input type="date" placeholder="DepartureDate" class="Air">
			<input type="time" placeholder="DepartureTime" class="Air">
			<input type="date" placeholder="ArrivalDate" class="Air">
			<input type="time" placeholder="ArrivalTime" class="Air">
			<input type="button" name="Add" class="submit-button" value="Add" onclick="PostMethodAir('Flight')">
		</form>
		<form  id="Car-Form">
			<input type="text" placeholder="Name" class="Car">
			<input type="text" placeholder="Price" class="Car">
			<input type="button" name="Add" class="submit-button" value="Add" onclick="PostMethodCar('Car')">
		</form>
		<form id="Hotel-Form">
			<input type="text" placeholder="Name" class="Hotel">
			<input type="text" placeholder="Price" class="Hotel">
			<input type="text" placeholder="Location" class="Hotel">
			<input type="button" name="Add" class="submit-button" value="Add" onclick="PostMethod('Hotel')">
		</form>
		<form id="Activity-Form">
			<input type="text" placeholder="Name" class="Activity">
			<input type="text" placeholder="Price" class="Activity">
			<input type="text" placeholder="Location" class="Activity">
			<input type="button" name="Add" class="submit-button" value="Add" onclick="PostMethod('Activity')">
		</form>
	</div>

<div id = 'tab-list'>
</div>
<p id = "demo"></p>
<!-- Tab content -->


<script>
function openCar(evt, bookingName) {
  document.getElementById("Car-Form").style.display = "block";
  document.getElementById("Hotel-Form").style.display = "none";
  document.getElementById("Activity-Form").style.display = "none";
  document.getElementById("Airways-Form").style.display = "none";
  ParseJsonAndCreateDivs(bookingName)
}

function openHotel(evt, bookingName) {
	document.getElementById("Car-Form").style.display = "none";
  	document.getElementById("Hotel-Form").style.display = "block";
  	document.getElementById("Activity-Form").style.display = "none";
  	document.getElementById("Airways-Form").style.display = "none";
   	ParseJsonAndCreateDivs(bookingName)
}

function openActivity(evt, bookingName)
{
	document.getElementById("Car-Form").style.display = "none";
  	document.getElementById("Hotel-Form").style.display = "none";
  	document.getElementById("Activity-Form").style.display = "block";
  	document.getElementById("Airways-Form").style.display = "none";
	ParseJsonAndCreateDivs(bookingName)
}

function openFlight(evt, bookingName)
{
	document.getElementById("Car-Form").style.display = "none";
  	document.getElementById("Hotel-Form").style.display = "none";
  	document.getElementById("Activity-Form").style.display = "none";
  	document.getElementById("Airways-Form").style.display = "block";
  	ParseJsonAndCreateDivs(bookingName)
}

function ParseJsonAndCreateDivs(bookingName)
{
     document.getElementById('tab-list').innerHTML = "";
    var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        var myArr = JSON.parse(this.responseText);
        if(myArr.length==0)
        {
        	alert("No Data Found")
        	return
        }
            for(var i=0;i<myArr.length;i++)
        {
            var iDiv = document.createElement('div');
            iDiv.id = i;
            iDiv.className = 'carList';
            document.getElementById('tab-list').appendChild(iDiv);
             var para = document.createElement("p");
            var node = document.createTextNode("Id: "+myArr[i].Id);
            para.appendChild(node);
            iDiv.appendChild(para);
            var para = document.createElement("p");
            var node = document.createTextNode("Name: "+myArr[i].Name);
            para.appendChild(node);
            iDiv.appendChild(para);
            var para = document.createElement("p");
            var node = document.createTextNode("Price: "+myArr[i].Price);
            para.appendChild(node);
            iDiv.appendChild(para);
              if(bookingName=="Flight")
            {
            var para = document.createElement("p");
            var node = document.createTextNode("Source: "+myArr[i].Source);
            para.appendChild(node);
            iDiv.appendChild(para);
             var para = document.createElement("p");
            var node = document.createTextNode("Destination: "+myArr[i].Destination);
            para.appendChild(node);
            iDiv.appendChild(para);
             var para = document.createElement("p");
            var node = document.createTextNode("DepartureDate: "+myArr[i].DepartureDate);
            para.appendChild(node);
            iDiv.appendChild(para);
             var para = document.createElement("p");
            var node = document.createTextNode("ArrivalDate: "+myArr[i].ArrivalDate);
            para.appendChild(node);
            iDiv.appendChild(para);
            var para = document.createElement("p");
            var node = document.createTextNode("DepartureTime: "+myArr[i].DepartureTime);
            para.appendChild(node);
            iDiv.appendChild(para);
             var para = document.createElement("p");
            var node = document.createTextNode("ArrivalTime: "+myArr[i].ArrivalTime);
            para.appendChild(node);
            iDiv.appendChild(para);
            }
            var para = document.createElement("p");
            var node = document.createTextNode("IsSaved: "+myArr[i].IsSaved);
            para.appendChild(node);
            iDiv.appendChild(para);
            var para = document.createElement("p");
            var node = document.createTextNode("IsBooked: "+myArr[i].IsBooked);
            para.appendChild(node);
            iDiv.appendChild(para);

        }
    }
};
xmlhttp.open("GET", "http://localhost:55308/api/"+bookingName, true);
xmlhttp.send();
location.reload();
}

function PostMethod(bookingName)
{
	console.log(document.getElementsByClassName(bookingName)[0].value);
	json = {
		"Name": document.getElementsByClassName(bookingName)[0].value,
		"Price": document.getElementsByClassName(bookingName)[1].value,
		"Location":document.getElementsByClassName(bookingName)[2].value,
		"IsSaved": "0",
		"IsBooked": "0"
	}
 json = JSON.stringify(json);
 var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
     console.log(this.responseText)
    }
};
xmlhttp.open("POST", "http://localhost:55308/api/"+bookingName, true);

xmlhttp.setRequestHeader("Content-Type", "application/json; charset=utf-8");
xmlhttp.send(json);
}

function PostMethodCar(bookingName)
{
	
	json = {
		"Name": document.getElementsByClassName("Car")[0].value,
		"Price": document.getElementsByClassName("Car")[1].value,
		"IsSaved": "0",
		"IsBooked": "0"
	}

 json = JSON.stringify(json);
 console.log(json);
 var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
     console.log(this.responseText)
    }
};
xmlhttp.open("POST", "http://localhost:55308/api/"+bookingName, true);

xmlhttp.setRequestHeader("Content-Type", "application/json; charset=utf-8");
xmlhttp.send(json);
}

function PostMethodAir(bookingName)
{
	
	json = {
		"Name": document.getElementsByClassName("Air")[0].value,
		"Price": document.getElementsByClassName("Air")[1].value,
		"Source":document.getElementsByClassName("Air")[2].value,
		"Destination":document.getElementsByClassName("Air")[3].value,
		"ArrivalDate":document.getElementsByClassName("Air")[4].value,
		"ArrivalTime":document.getElementsByClassName("Air")[5].value,
		"DepartureDate":document.getElementsByClassName("Air")[6].value,
		"DepartureTime":document.getElementsByClassName("Air")[7].value,
		"IsSaved": "0",
		"IsBooked": "0"
	}
 json = JSON.stringify(json);
 var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
     console.log(this.responseText)
    }
};
xmlhttp.open("POST", "http://localhost:55308/api/"+bookingName, true);

xmlhttp.setRequestHeader("Content-Type", "application/json; charset=utf-8");
xmlhttp.send(json);
}

</script>
</body> 
</html>